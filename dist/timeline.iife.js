var $timeline=function(){var J,L,P,w,U,Z,it,bt,nt,St,rt,Tt,at,Ft,ot,Ct,ht,Ht,G,Dt,R,mt,Q,wt;"use strict";var It=Object.defineProperty;var jt=(M,v,x)=>v in M?It(M,v,{enumerable:!0,configurable:!0,writable:!0,value:x}):M[v]=x;var st=(M,v,x)=>(jt(M,typeof v!="symbol"?v+"":v,x),x),Yt=(M,v,x)=>{if(!v.has(M))throw TypeError("Cannot "+x)};var f=(M,v,x)=>(Yt(M,v,"read from private field"),x?x.call(M):v.get(M)),F=(M,v,x)=>{if(v.has(M))throw TypeError("Cannot add the same private member more than once");v instanceof WeakSet?v.add(M):v.set(M,x)},A=(M,v,x,V)=>(Yt(M,v,"write to private field"),V?V.call(M,x):v.set(M,x),x);var _=(M,v,x)=>(Yt(M,v,"access private method"),x);function M(u){return{all:u=u||new Map,on:function(i,r){var n=u.get(i);n?n.push(r):u.set(i,[r])},off:function(i,r){var n=u.get(i);n&&(r?n.splice(n.indexOf(r)>>>0,1):u.set(i,[]))},emit:function(i,r){var n=u.get(i);n&&n.slice().map(function(l){l(r)}),(n=u.get("*"))&&n.slice().map(function(l){l(i,r)})}}}var v=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function x(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var V={exports:{}};(function(u,i){(function(r,n){u.exports=n()})(v,function(){var r=1e3,n=6e4,l=36e5,$="millisecond",d="second",p="minute",Y="hour",y="day",C="week",H="month",O="quarter",W="year",z="date",ct="Invalid Date",$t=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,ut=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,vt={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(a){var s=["th","st","nd","rd"],t=a%100;return"["+a+(s[(t-20)%10]||s[t]||s[0])+"]"}},I=function(a,s,t){var o=String(a);return!o||o.length>=s?a:""+Array(s+1-o.length).join(t)+a},K={s:I,z:function(a){var s=-a.utcOffset(),t=Math.abs(s),o=Math.floor(t/60),e=t%60;return(s<=0?"+":"-")+I(o,2,"0")+":"+I(e,2,"0")},m:function a(s,t){if(s.date()<t.date())return-a(t,s);var o=12*(t.year()-s.year())+(t.month()-s.month()),e=s.clone().add(o,H),c=t-e<0,h=s.clone().add(o+(c?-1:1),H);return+(-(o+(t-e)/(c?e-h:h-e))||0)},a:function(a){return a<0?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:H,y:W,w:C,d:y,D:z,h:Y,m:p,s:d,ms:$,Q:O}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return a===void 0}},j="en",B={};B[j]=vt;var pt=function(a){return a instanceof lt},ft=function a(s,t,o){var e;if(!s)return j;if(typeof s=="string"){var c=s.toLowerCase();B[c]&&(e=c),t&&(B[c]=t,e=c);var h=s.split("-");if(!e&&h.length>1)return a(h[0])}else{var g=s.name;B[g]=s,e=g}return!o&&e&&(j=e),e||!o&&j},S=function(a,s){if(pt(a))return a.clone();var t=typeof s=="object"?s:{};return t.date=a,t.args=arguments,new lt(t)},m=K;m.l=ft,m.i=pt,m.w=function(a,s){return S(a,{locale:s.$L,utc:s.$u,x:s.$x,$offset:s.$offset})};var lt=function(){function a(t){this.$L=ft(t.locale,null,!0),this.parse(t)}var s=a.prototype;return s.parse=function(t){this.$d=function(o){var e=o.date,c=o.utc;if(e===null)return new Date(NaN);if(m.u(e))return new Date;if(e instanceof Date)return new Date(e);if(typeof e=="string"&&!/Z$/i.test(e)){var h=e.match($t);if(h){var g=h[2]-1||0,b=(h[7]||"0").substring(0,3);return c?new Date(Date.UTC(h[1],g,h[3]||1,h[4]||0,h[5]||0,h[6]||0,b)):new Date(h[1],g,h[3]||1,h[4]||0,h[5]||0,h[6]||0,b)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},s.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},s.$utils=function(){return m},s.isValid=function(){return this.$d.toString()!==ct},s.isSame=function(t,o){var e=S(t);return this.startOf(o)<=e&&e<=this.endOf(o)},s.isAfter=function(t,o){return S(t)<this.startOf(o)},s.isBefore=function(t,o){return this.endOf(o)<S(t)},s.$g=function(t,o,e){return m.u(t)?this[o]:this.set(e,t)},s.unix=function(){return Math.floor(this.valueOf()/1e3)},s.valueOf=function(){return this.$d.getTime()},s.startOf=function(t,o){var e=this,c=!!m.u(o)||o,h=m.p(t),g=function(q,E){var N=m.w(e.$u?Date.UTC(e.$y,E,q):new Date(e.$y,E,q),e);return c?N:N.endOf(y)},b=function(q,E){return m.w(e.toDate()[q].apply(e.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(E)),e)},D=this.$W,T=this.$M,X=this.$D,k="set"+(this.$u?"UTC":"");switch(h){case W:return c?g(1,0):g(31,11);case H:return c?g(1,T):g(0,T+1);case C:var tt=this.$locale().weekStart||0,et=(D<tt?D+7:D)-tt;return g(c?X-et:X+(6-et),T);case y:case z:return b(k+"Hours",0);case Y:return b(k+"Minutes",1);case p:return b(k+"Seconds",2);case d:return b(k+"Milliseconds",3);default:return this.clone()}},s.endOf=function(t){return this.startOf(t,!1)},s.$set=function(t,o){var e,c=m.p(t),h="set"+(this.$u?"UTC":""),g=(e={},e[y]=h+"Date",e[z]=h+"Date",e[H]=h+"Month",e[W]=h+"FullYear",e[Y]=h+"Hours",e[p]=h+"Minutes",e[d]=h+"Seconds",e[$]=h+"Milliseconds",e)[c],b=c===y?this.$D+(o-this.$W):o;if(c===H||c===W){var D=this.clone().set(z,1);D.$d[g](b),D.init(),this.$d=D.set(z,Math.min(this.$D,D.daysInMonth())).$d}else g&&this.$d[g](b);return this.init(),this},s.set=function(t,o){return this.clone().$set(t,o)},s.get=function(t){return this[m.p(t)]()},s.add=function(t,o){var e,c=this;t=Number(t);var h=m.p(o),g=function(T){var X=S(c);return m.w(X.date(X.date()+Math.round(T*t)),c)};if(h===H)return this.set(H,this.$M+t);if(h===W)return this.set(W,this.$y+t);if(h===y)return g(1);if(h===C)return g(7);var b=(e={},e[p]=n,e[Y]=l,e[d]=r,e)[h]||1,D=this.$d.getTime()+t*b;return m.w(D,this)},s.subtract=function(t,o){return this.add(-1*t,o)},s.format=function(t){var o=this,e=this.$locale();if(!this.isValid())return e.invalidDate||ct;var c=t||"YYYY-MM-DDTHH:mm:ssZ",h=m.z(this),g=this.$H,b=this.$m,D=this.$M,T=e.weekdays,X=e.months,k=function(E,N,Mt,dt){return E&&(E[N]||E(o,c))||Mt[N].slice(0,dt)},tt=function(E){return m.s(g%12||12,E,"0")},et=e.meridiem||function(E,N,Mt){var dt=E<12?"AM":"PM";return Mt?dt.toLowerCase():dt},q={YY:String(this.$y).slice(-2),YYYY:m.s(this.$y,4,"0"),M:D+1,MM:m.s(D+1,2,"0"),MMM:k(e.monthsShort,D,X,3),MMMM:k(X,D),D:this.$D,DD:m.s(this.$D,2,"0"),d:String(this.$W),dd:k(e.weekdaysMin,this.$W,T,2),ddd:k(e.weekdaysShort,this.$W,T,3),dddd:T[this.$W],H:String(g),HH:m.s(g,2,"0"),h:tt(1),hh:tt(2),a:et(g,b,!0),A:et(g,b,!1),m:String(b),mm:m.s(b,2,"0"),s:String(this.$s),ss:m.s(this.$s,2,"0"),SSS:m.s(this.$ms,3,"0"),Z:h};return c.replace(ut,function(E,N){return N||q[E]||h.replace(":","")})},s.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},s.diff=function(t,o,e){var c,h=m.p(o),g=S(t),b=(g.utcOffset()-this.utcOffset())*n,D=this-g,T=m.m(this,g);return T=(c={},c[W]=T/12,c[H]=T,c[O]=T/3,c[C]=(D-b)/6048e5,c[y]=(D-b)/864e5,c[Y]=D/l,c[p]=D/n,c[d]=D/r,c)[h]||D,e?T:m.a(T)},s.daysInMonth=function(){return this.endOf(H).$D},s.$locale=function(){return B[this.$L]},s.locale=function(t,o){if(!t)return this.$L;var e=this.clone(),c=ft(t,o,!0);return c&&(e.$L=c),e},s.clone=function(){return m.w(this.$d,this)},s.toDate=function(){return new Date(this.valueOf())},s.toJSON=function(){return this.isValid()?this.toISOString():null},s.toISOString=function(){return this.$d.toISOString()},s.toString=function(){return this.$d.toUTCString()},a}(),xt=lt.prototype;return S.prototype=xt,[["$ms",$],["$s",d],["$m",p],["$H",Y],["$W",y],["$M",H],["$y",W],["$D",z]].forEach(function(a){xt[a[1]]=function(s){return this.$g(s,a[0],a[1])}}),S.extend=function(a,s){return a.$i||(a(s,lt,S),a.$i=!0),S},S.locale=ft,S.isDayjs=pt,S.unix=function(a){return S(1e3*a)},S.en=B[j],S.Ls=B,S.p={},S})})(V);var Lt=V.exports;const Ot=x(Lt);function Et(u,i){const r=_t(u),n=Wt(i,0,1),l={...r,a:n};return At(l)}function _t(u){const i=document.createElement("canvas");i.width=i.height=1;const r=i.getContext("2d");r.fillStyle=u,r.fillRect(0,0,1,1);const n=r.getImageData(0,0,1,1).data;return{r:n[0],g:n[1],b:n[2],a:n[3]/255}}function At(u){return`rgba(${u.r}, ${u.g}, ${u.b}, ${u.a})`}function Wt(u,i,r){return Math.min(Math.max(u,i),r)}const gt=(u,i="MM/DD HH:mm")=>Ot(u).format(i),yt=(u,i)=>{let r,n=0;return(...l)=>{const $=Date.now(),d=$-n;!n||d>=i?(n=$,u.apply(void 0,l)):r||(r=setTimeout(()=>{n=$,u.apply(void 0,l),r=null},i-d))}},Pt=({xCenterPoint:u,cfg:i,timePerPixel:r,timeSpacing:n,currentTime:l,$canvas:$,screenScaleCount:d,scaleHeight:p,startTime:Y,drawLine:y,drawText:C,drawArea:H})=>{const O=({space:W,scaleFormat:z,bgFormat:ct,currentFormat:$t})=>{C({x:$.width-u/10,y:6,text:gt(l,ct),fontSize:`${$.height-5}px`,align:"right",baseLine:"top",color:Et(i.textColor,.18)});const ut=Y%n,vt=ut/r;for(let I=0;I<d;I++){const K=I*i.scaleSpacing-vt-i.pointWidth/2,j=Y+I*n-ut;if(j%(n*W)===0){y({x:K,y:p.long}),C({x:K,y:$.height-p.long-5,text:gt(j,z),baseLine:"bottom"});continue}y({x:K,y:p.short})}y({x:u-i.pointWidth/2,y:$.height,width:i.pointWidth,color:i.pointColor}),H({startX:u-50,startY:4,endX:u+50,endY:18,bgColor:i.pointColor}),C({x:u,y:6,text:gt(l,$t),align:"center",baseLine:"top"})};n<100?O({space:10,scaleFormat:"mm:ss:SSS",bgFormat:"YYYY/MM/DD",currentFormat:"HH:mm:ss:SSS"}):n<1e3?O({space:10,scaleFormat:"mm:ss",bgFormat:"YYYY/MM/DD",currentFormat:"HH:mm:ss:SSS"}):n<1e4?O({space:10,scaleFormat:"mm:ss",bgFormat:"YYYY/MM/DD",currentFormat:"HH:mm:ss"}):n<6e4?O({space:12,scaleFormat:"HH:mm:ss",bgFormat:"YYYY/MM/DD",currentFormat:"HH:mm:ss"}):n<6e5?O({space:10,scaleFormat:"HH:mm:ss",bgFormat:"YYYY/MM/DD",currentFormat:"HH:mm:ss"}):n<36e5?O({space:12,scaleFormat:"MM/DD HH:mm",bgFormat:"YYYY/MM",currentFormat:"MM/DD HH:mm:ss"}):n<864e5?O({space:12,scaleFormat:"MM/DD HH:mm",bgFormat:"YYYY/MM",currentFormat:"YYYY/MM/DD HH:mm"}):n<6048e5?O({space:10,scaleFormat:"YYYY/MM/DD",bgFormat:"YYYY",currentFormat:"YYYY/MM/DD"}):O({space:10,scaleFormat:"YYYY/MM/DD",bgFormat:"YYYY",currentFormat:"YYYY/MM/DD"})},kt={fill:!0,bgColor:"rgba(0,0,0,0.5)",areaBgColor:"#ffffff55",textColor:"#ffffff",scaleColor:"#ffffff",pointColor:"#00aeec",pointWidth:3,scaleSpacing:7,fps:60,zoom:2,timeSpacingList:[10,100,1e3,1e4,6e4,6e5,36e5,864e5,6048e5]};class zt{constructor(i,r){F(this,it);F(this,nt);F(this,rt);F(this,at);F(this,ot);F(this,ht);F(this,G);F(this,R);F(this,Q);st(this,"$canvas");st(this,"ctx");st(this,"$canvasParent");st(this,"cfg");F(this,J,M());F(this,L,0);F(this,P,void 0);F(this,w,void 0);F(this,U,void 0);F(this,Z,!1);if(!i)throw new Error("canvas Element Or Element ID is required!");if(typeof i=="string"?this.$canvas=document.querySelector(i):this.$canvas=i,!(this.$canvas instanceof HTMLCanvasElement))throw new Error("element must be canvas!");this.ctx=this.$canvas.getContext("2d"),this.cfg={...kt,...r};const{fill:n,width:l,height:$,zoom:d,timeSpacingList:p,scaleHeight:Y}=this.cfg;if(d<0||d>=p.length||d%1!==0)throw new Error(`zoom must be 0 ~ ${p.length-1}, and must be an integer`);if(n){const y=this.$canvas.parentElement;this.$canvasParent=y,this.$canvas.width=y.clientWidth,this.$canvas.height=y.clientHeight,new ResizeObserver(yt(_(this,rt,Tt).bind(this),200)).observe(y)}else l&&(this.$canvas.width=l),$&&(this.$canvas.height=$);A(this,w,p[d]),Y!=null&&Y.long&&(Y!=null&&Y.short)?A(this,U,Y):A(this,U,{long:this.$canvas.height/3,medium:this.$canvas.height/6,short:this.$canvas.height/10}),this.$canvas.addEventListener("wheel",_(this,nt,St).bind(this),{passive:!1}),this.$canvas.addEventListener("mousedown",_(this,it,bt).bind(this))}draw({currentTime:i,areas:r,_privateFlag:n}={}){if(f(this,Z)&&!n)return;A(this,L,i||Date.now()),A(this,P,r||[]);const l=Math.ceil(this.$canvas.width/this.cfg.scaleSpacing),$=l*f(this,w),d=f(this,L)-$/2,p=f(this,L)+$/2,Y=this.$canvas.width/2,y=$/this.$canvas.width;_(this,at,Ft).call(this),_(this,R,mt).call(this,{startX:0,startY:0,endX:this.$canvas.width,endY:this.$canvas.height,bgColor:this.cfg.bgColor}),f(this,P).forEach(C=>{const H=C.startTime<d?0:Math.floor((C.startTime-d)/y),O=C.endTime>p?this.$canvas.width:Math.floor((C.endTime-d)/y);_(this,R,mt).call(this,{startX:H,startY:0,endX:O,endY:this.$canvas.height,bgColor:C.bgColor||this.cfg.areaBgColor})}),Pt.bind(this)({xCenterPoint:Y,screenScaleCount:l,startTime:d,timePerPixel:y,scaleHeight:f(this,U),timeSpacing:f(this,w),currentTime:f(this,L),$canvas:this.$canvas,cfg:this.cfg,drawLine:_(this,ht,Ht).bind(this),drawText:_(this,G,Dt).bind(this),drawArea:_(this,R,mt).bind(this)}),_(this,ot,Ct).call(this)}getCurrentTime(){return f(this,L)}on(i,r){f(this,J).on(i,r)}off(i,r){f(this,J).off(i,r)}}return J=new WeakMap,L=new WeakMap,P=new WeakMap,w=new WeakMap,U=new WeakMap,Z=new WeakMap,it=new WeakSet,bt=function(i){A(this,Z,!0);let r=0;const n=yt(({offsetX:d})=>{const p=d-i.offsetX,Y=f(this,L)-f(this,w)/this.cfg.scaleSpacing*(p-r);r=p,this.draw({currentTime:Math.round(Y),areas:f(this,P),_privateFlag:!0})},1e3/this.cfg.fps),l=({offsetX:d,offsetY:p})=>{(d<3||d>this.$canvas.width-3||p<3||p>this.$canvas.height-3)&&(this.$canvas.removeEventListener("mousemove",n),this.$canvas.removeEventListener("mousemove",l),A(this,Z,!1),_(this,Q,wt).call(this,"dragend",f(this,L)))},$=()=>{this.$canvas.removeEventListener("mousemove",n),this.$canvas.removeEventListener("mousemove",l),A(this,Z,!1),_(this,Q,wt).call(this,"dragend",f(this,L)),document.removeEventListener("mouseup",$)};this.$canvas.addEventListener("mousemove",n),this.$canvas.addEventListener("mousemove",l),document.addEventListener("mouseup",$)},nt=new WeakSet,St=function(i){i.preventDefault();const r=this.cfg.timeSpacingList.findIndex(n=>n===f(this,w));i.deltaY<0&&r>0?(A(this,w,this.cfg.timeSpacingList[r-1]),this.draw({currentTime:f(this,L),areas:f(this,P),_privateFlag:!0})):i.deltaY>0&&r<this.cfg.timeSpacingList.length-1&&(A(this,w,this.cfg.timeSpacingList[r+1]),this.draw({currentTime:f(this,L),areas:f(this,P),_privateFlag:!0}))},rt=new WeakSet,Tt=function(){this.$canvasParent&&(this.$canvas.width=this.$canvasParent.clientWidth,this.$canvas.height=this.$canvasParent.clientHeight,this.cfg.scaleHeight||A(this,U,{long:this.$canvas.height/3,medium:this.$canvas.height/6,short:this.$canvas.height/10}),this.draw({currentTime:f(this,L),areas:f(this,P)}))},at=new WeakSet,Ft=function(){this.ctx.clearRect(0,0,this.$canvas.width,this.$canvas.height)},ot=new WeakSet,Ct=function(){const i=()=>f(this,w)<1e3?`${f(this,w)}ms`:f(this,w)<6e4?`${Math.round(f(this,w)/100)/10}sec`:f(this,w)<36e5?`${Math.round(f(this,w)/100/60)/10}min`:f(this,w)<864e5?`${Math.round(f(this,w)/100/60/60)/10}hours`:f(this,w)<6048e5?`${Math.round(f(this,w)/100/60/60/24)/10}days`:`${Math.round(f(this,w)/100/60/60/24/7)/10}weeks`;_(this,G,Dt).call(this,{x:this.cfg.scaleSpacing+12,y:9,text:i(),align:"left",baseLine:"middle"}),this.ctx.beginPath(),this.ctx.moveTo(5,6),this.ctx.lineTo(5,10),this.ctx.lineTo(this.cfg.scaleSpacing+6,10),this.ctx.lineTo(this.cfg.scaleSpacing+6,6),this.ctx.strokeStyle=this.cfg.scaleColor,this.ctx.lineWidth=1.5,this.ctx.stroke()},ht=new WeakSet,Ht=function({x:i,y:r,width:n=1,color:l=this.cfg.scaleColor}){this.ctx.beginPath(),this.ctx.moveTo(i,this.$canvas.height),this.ctx.lineTo(i,this.$canvas.height-r),this.ctx.closePath(),this.ctx.strokeStyle=l,this.ctx.lineWidth=n,this.ctx.stroke()},G=new WeakSet,Dt=function({x:i,y:r,text:n,color:l=this.cfg.textColor,fontSize:$="11px",align:d="center",baseLine:p="alphabetic"}){this.ctx.beginPath(),this.ctx.font=`${$} Arial`,this.ctx.fillStyle=l,this.ctx.textAlign=d,this.ctx.textBaseline=p,this.ctx.fillText(n,i,r)},R=new WeakSet,mt=function({startX:i,startY:r,endX:n,endY:l,bgColor:$}){this.ctx.beginPath(),this.ctx.rect(i,r,n-i,l-r),this.ctx.fillStyle=$,this.ctx.fill()},Q=new WeakSet,wt=function(...i){f(this,J).emit(...i)},zt}();
