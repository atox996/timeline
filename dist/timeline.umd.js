(function(d,m){typeof exports=="object"&&typeof module<"u"?m(exports):typeof define=="function"&&define.amd?define(["exports"],m):(d=typeof globalThis<"u"?globalThis:d||self,m(d.$timeline={}))})(this,function(d){"use strict";var kt=Object.defineProperty;var Dt=d=>{throw TypeError(d)};var Pt=(d,m,Y)=>m in d?kt(d,m,{enumerable:!0,configurable:!0,writable:!0,value:Y}):d[m]=Y;var st=(d,m,Y)=>Pt(d,typeof m!="symbol"?m+"":m,Y),gt=(d,m,Y)=>m.has(d)||Dt("Cannot "+Y);var a=(d,m,Y)=>(gt(d,m,"read from private field"),Y?Y.call(d):m.get(d)),k=(d,m,Y)=>m.has(d)?Dt("Cannot add the same private member more than once"):m instanceof WeakSet?m.add(d):m.set(d,Y),L=(d,m,Y,nt)=>(gt(d,m,"write to private field"),nt?nt.call(d,Y):m.set(d,Y),Y),j=(d,m,Y)=>(gt(d,m,"access private method"),Y);var q,O,A,D,U,P,I,b,yt,bt,wt,St,Yt,xt,Ft,Ht,at,K,V,$t;function m(f){return{all:f=f||new Map,on:function(i,n){var o=f.get(i);o?o.push(n):f.set(i,[n])},off:function(i,n){var o=f.get(i);o&&(n?o.splice(o.indexOf(n)>>>0,1):f.set(i,[]))},emit:function(i,n){var o=f.get(i);o&&o.slice().map(function(l){l(n)}),(o=f.get("*"))&&o.slice().map(function(l){l(i,n)})}}}var Y=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nt(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}var vt={exports:{}};(function(f,i){(function(n,o){f.exports=o()})(Y,function(){var n=1e3,o=6e4,l=36e5,$="millisecond",v="second",T="minute",y="hour",w="day",x="week",p="month",B="quarter",_="year",N="date",ot="Invalid Date",dt=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,ft=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,ht={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(h){var s=["th","st","nd","rd"],t=h%100;return"["+h+(s[(t-20)%10]||s[t]||s[0])+"]"}},tt=function(h,s,t){var r=String(h);return!r||r.length>=s?h:""+Array(s+1-r.length).join(t)+h},G={s:tt,z:function(h){var s=-h.utcOffset(),t=Math.abs(s),r=Math.floor(t/60),e=t%60;return(s<=0?"+":"-")+tt(r,2,"0")+":"+tt(e,2,"0")},m:function h(s,t){if(s.date()<t.date())return-h(t,s);var r=12*(t.year()-s.year())+(t.month()-s.month()),e=s.clone().add(r,p),c=t-e<0,u=s.clone().add(r+(c?-1:1),p);return+(-(r+(t-e)/(c?e-u:u-e))||0)},a:function(h){return h<0?Math.ceil(h)||0:Math.floor(h)},p:function(h){return{M:p,y:_,w:x,d:w,D:N,h:y,m:T,s:v,ms:$,Q:B}[h]||String(h||"").toLowerCase().replace(/s$/,"")},u:function(h){return h===void 0}},z="en",X={};X[z]=ht;var Mt="$isDayjsObject",mt=function(h){return h instanceof ut||!(!h||!h[Mt])},ct=function h(s,t,r){var e;if(!s)return z;if(typeof s=="string"){var c=s.toLowerCase();X[c]&&(e=c),t&&(X[c]=t,e=c);var u=s.split("-");if(!e&&u.length>1)return h(u[0])}else{var M=s.name;X[M]=s,e=M}return!r&&e&&(z=e),e||!r&&z},F=function(h,s){if(mt(h))return h.clone();var t=typeof s=="object"?s:{};return t.date=h,t.args=arguments,new ut(t)},g=G;g.l=ct,g.i=mt,g.w=function(h,s){return F(h,{locale:s.$L,utc:s.$u,x:s.$x,$offset:s.$offset})};var ut=function(){function h(t){this.$L=ct(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[Mt]=!0}var s=h.prototype;return s.parse=function(t){this.$d=function(r){var e=r.date,c=r.utc;if(e===null)return new Date(NaN);if(g.u(e))return new Date;if(e instanceof Date)return new Date(e);if(typeof e=="string"&&!/Z$/i.test(e)){var u=e.match(dt);if(u){var M=u[2]-1||0,S=(u[7]||"0").substring(0,3);return c?new Date(Date.UTC(u[1],M,u[3]||1,u[4]||0,u[5]||0,u[6]||0,S)):new Date(u[1],M,u[3]||1,u[4]||0,u[5]||0,u[6]||0,S)}}return new Date(e)}(t),this.init()},s.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},s.$utils=function(){return g},s.isValid=function(){return this.$d.toString()!==ot},s.isSame=function(t,r){var e=F(t);return this.startOf(r)<=e&&e<=this.endOf(r)},s.isAfter=function(t,r){return F(t)<this.startOf(r)},s.isBefore=function(t,r){return this.endOf(r)<F(t)},s.$g=function(t,r,e){return g.u(t)?this[r]:this.set(e,t)},s.unix=function(){return Math.floor(this.valueOf()/1e3)},s.valueOf=function(){return this.$d.getTime()},s.startOf=function(t,r){var e=this,c=!!g.u(r)||r,u=g.p(t),M=function(J,E){var R=g.w(e.$u?Date.UTC(e.$y,E,J):new Date(e.$y,E,J),e);return c?R:R.endOf(w)},S=function(J,E){return g.w(e.toDate()[J].apply(e.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(E)),e)},H=this.$W,C=this.$M,W=this.$D,Q="set"+(this.$u?"UTC":"");switch(u){case _:return c?M(1,0):M(31,11);case p:return c?M(1,C):M(0,C+1);case x:var Z=this.$locale().weekStart||0,et=(H<Z?H+7:H)-Z;return M(c?W-et:W+(6-et),C);case w:case N:return S(Q+"Hours",0);case y:return S(Q+"Minutes",1);case T:return S(Q+"Seconds",2);case v:return S(Q+"Milliseconds",3);default:return this.clone()}},s.endOf=function(t){return this.startOf(t,!1)},s.$set=function(t,r){var e,c=g.p(t),u="set"+(this.$u?"UTC":""),M=(e={},e[w]=u+"Date",e[N]=u+"Date",e[p]=u+"Month",e[_]=u+"FullYear",e[y]=u+"Hours",e[T]=u+"Minutes",e[v]=u+"Seconds",e[$]=u+"Milliseconds",e)[c],S=c===w?this.$D+(r-this.$W):r;if(c===p||c===_){var H=this.clone().set(N,1);H.$d[M](S),H.init(),this.$d=H.set(N,Math.min(this.$D,H.daysInMonth())).$d}else M&&this.$d[M](S);return this.init(),this},s.set=function(t,r){return this.clone().$set(t,r)},s.get=function(t){return this[g.p(t)]()},s.add=function(t,r){var e,c=this;t=Number(t);var u=g.p(r),M=function(C){var W=F(c);return g.w(W.date(W.date()+Math.round(C*t)),c)};if(u===p)return this.set(p,this.$M+t);if(u===_)return this.set(_,this.$y+t);if(u===w)return M(1);if(u===x)return M(7);var S=(e={},e[T]=o,e[y]=l,e[v]=n,e)[u]||1,H=this.$d.getTime()+t*S;return g.w(H,this)},s.subtract=function(t,r){return this.add(-1*t,r)},s.format=function(t){var r=this,e=this.$locale();if(!this.isValid())return e.invalidDate||ot;var c=t||"YYYY-MM-DDTHH:mm:ssZ",u=g.z(this),M=this.$H,S=this.$m,H=this.$M,C=e.weekdays,W=e.months,Q=e.meridiem,Z=function(E,R,it,lt){return E&&(E[R]||E(r,c))||it[R].slice(0,lt)},et=function(E){return g.s(M%12||12,E,"0")},J=Q||function(E,R,it){var lt=E<12?"AM":"PM";return it?lt.toLowerCase():lt};return c.replace(ft,function(E,R){return R||function(it){switch(it){case"YY":return String(r.$y).slice(-2);case"YYYY":return g.s(r.$y,4,"0");case"M":return H+1;case"MM":return g.s(H+1,2,"0");case"MMM":return Z(e.monthsShort,H,W,3);case"MMMM":return Z(W,H);case"D":return r.$D;case"DD":return g.s(r.$D,2,"0");case"d":return String(r.$W);case"dd":return Z(e.weekdaysMin,r.$W,C,2);case"ddd":return Z(e.weekdaysShort,r.$W,C,3);case"dddd":return C[r.$W];case"H":return String(M);case"HH":return g.s(M,2,"0");case"h":return et(1);case"hh":return et(2);case"a":return J(M,S,!0);case"A":return J(M,S,!1);case"m":return String(S);case"mm":return g.s(S,2,"0");case"s":return String(r.$s);case"ss":return g.s(r.$s,2,"0");case"SSS":return g.s(r.$ms,3,"0");case"Z":return u}return null}(E)||u.replace(":","")})},s.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},s.diff=function(t,r,e){var c,u=this,M=g.p(r),S=F(t),H=(S.utcOffset()-this.utcOffset())*o,C=this-S,W=function(){return g.m(u,S)};switch(M){case _:c=W()/12;break;case p:c=W();break;case B:c=W()/3;break;case x:c=(C-H)/6048e5;break;case w:c=(C-H)/864e5;break;case y:c=C/l;break;case T:c=C/o;break;case v:c=C/n;break;default:c=C}return e?c:g.a(c)},s.daysInMonth=function(){return this.endOf(p).$D},s.$locale=function(){return X[this.$L]},s.locale=function(t,r){if(!t)return this.$L;var e=this.clone(),c=ct(t,r,!0);return c&&(e.$L=c),e},s.clone=function(){return g.w(this.$d,this)},s.toDate=function(){return new Date(this.valueOf())},s.toJSON=function(){return this.isValid()?this.toISOString():null},s.toISOString=function(){return this.$d.toISOString()},s.toString=function(){return this.$d.toUTCString()},h}(),Tt=ut.prototype;return F.prototype=Tt,[["$ms",$],["$s",v],["$m",T],["$H",y],["$W",w],["$M",p],["$y",_],["$D",N]].forEach(function(h){Tt[h[1]]=function(s){return this.$g(s,h[0],h[1])}}),F.extend=function(h,s){return h.$i||(h(s,ut,F),h.$i=!0),F},F.locale=ct,F.isDayjs=mt,F.unix=function(h){return F(1e3*h)},F.en=X[z],F.Ls=X,F.p={},F})})(vt);var Ct=vt.exports;const Lt=nt(Ct),rt=(f,i="MM/DD HH:mm")=>Lt(f).format(i),pt=(f,i)=>{let n,o=0;return(...l)=>{const $=Date.now(),v=$-o;!o||v>=i?(o=$,f.apply(void 0,l)):n||(n=setTimeout(()=>{o=$,f.apply(void 0,l),n=null},i-v))}},Ot=(f,i)=>{const n=document.createElement("canvas");n.width=n.height=1;const o=n.getContext("2d");o.fillStyle=f,o.fillRect(0,0,1,1);const l=o.getImageData(0,0,1,1).data;return`rgba(${l[0]}, ${l[1]}, ${l[2]}, ${i})`},_t=({xCenterPoint:f,cfg:i,timePerPixel:n,timeSpacing:o,currentTime:l,$canvas:$,screenScaleCount:v,scaleHeight:T,startTime:y,drawLine:w,drawText:x,drawArea:p})=>{const B=({space:N,scaleTimeFormat:ot,bgTimeFormat:dt,pointerTimeFormat:ft})=>{x({x:$.width-f/10,y:6,text:rt(l,dt),fontSize:`${$.height-5}px`,align:"right",baseLine:"top",color:i.bgTextColor});const ht=y%o,tt=ht/n;for(let G=0;G<v;G++){const z=G*i.scaleSpacing-tt-i.pointerWidth/2,X=y+G*o-ht;if(X%(o*N)===0){w({x:z,y:T.long}),x({x:z,y:$.height-T.long-5,text:rt(X,ot),baseLine:"bottom"});continue}w({x:z,y:T.short})}w({x:f-i.pointerWidth/2,y:$.height,width:i.pointerWidth,color:i.pointerColor}),p({startX:f-i.pointerDisplayWidth/2,startY:4,endX:f+i.pointerDisplayWidth/2,endY:4+i.pointerDisplayHeight,bgColor:i.pointerColor}),x({x:f,y:i.pointerDisplayHeight/2+5,text:rt(l,ft),align:"center",baseLine:"middle"})},_=i.thresholdsConfig[o];_&&B({space:_.space,scaleTimeFormat:_.scaleTimeFormat,bgTimeFormat:_.bgTimeFormat,pointerTimeFormat:_.pointerTimeFormat})},Et={fill:!0,width:1e3,height:60,bgColor:"rgba(0,0,0,0.5)",textColor:"#ffffff",fontFamily:"Arial",scaleColor:"#ffffff",scaleSpacing:7,areaBgColor:"#ffffff55",pointerColor:"#00aeec",pointerWidth:3,pointerDisplayWidth:100,pointerDisplayHeight:14,fps:60,zoom:3,timeSpacingList:[10,100,1e3,1e4,6e4,6e5,36e5,864e5,6048e5],thresholdsConfig:{10:{scaleTimeFormat:"mm:ss:SSS",bgTimeFormat:"YYYY/MM/DD",pointerTimeFormat:"HH:mm:ss:SSS",space:10},100:{scaleTimeFormat:"mm:ss",bgTimeFormat:"YYYY/MM/DD",pointerTimeFormat:"HH:mm:ss:SSS",space:10},1e3:{scaleTimeFormat:"mm:ss",bgTimeFormat:"YYYY/MM/DD",pointerTimeFormat:"HH:mm:ss",space:10},1e4:{scaleTimeFormat:"HH:mm:ss",bgTimeFormat:"YYYY/MM/DD",pointerTimeFormat:"HH:mm:ss",space:12},6e4:{scaleTimeFormat:"HH:mm",bgTimeFormat:"YYYY/MM/DD",pointerTimeFormat:"HH:mm:ss",space:10},6e5:{scaleTimeFormat:"HH:mm",bgTimeFormat:"YYYY/MM/DD",pointerTimeFormat:"HH:mm:ss",space:10},36e5:{scaleTimeFormat:"MM/DD HH:mm",bgTimeFormat:"YYYY/MM",pointerTimeFormat:"MM/DD HH:mm",space:12},864e5:{scaleTimeFormat:"MM/DD HH:mm",bgTimeFormat:"YYYY/MM",pointerTimeFormat:"YYYY/MM/DD HH:mm",space:12},6048e5:{scaleTimeFormat:"YYYY/MM/DD",bgTimeFormat:"YYYY",pointerTimeFormat:"YYYY/MM/DD",space:10}}};class Wt{constructor(i,n){k(this,b);st(this,"$canvas");st(this,"$canvasParent");st(this,"ctx");st(this,"cfg");k(this,q,m());k(this,O,0);k(this,A);k(this,D);k(this,U);k(this,P,!1);k(this,I,null);k(this,at,({x:i,y:n,width:o=1,color:l=this.cfg.scaleColor})=>{this.ctx.beginPath(),this.ctx.moveTo(i,this.$canvas.height),this.ctx.lineTo(i,this.$canvas.height-n),this.ctx.closePath(),this.ctx.strokeStyle=l,this.ctx.lineWidth=o,this.ctx.stroke()});k(this,K,({x:i,y:n,text:o,color:l=this.cfg.textColor,fontSize:$="11px",align:v="center",baseLine:T="alphabetic"})=>{this.ctx.beginPath(),this.ctx.font=`${$} ${this.cfg.fontFamily}`,this.ctx.fillStyle=l,this.ctx.textAlign=v,this.ctx.textBaseline=T,this.ctx.fillText(o,i,n)});k(this,V,({startX:i,startY:n,endX:o,endY:l,bgColor:$})=>{this.ctx.beginPath(),this.ctx.rect(i,n,o-i,l-n),this.ctx.fillStyle=$,this.ctx.fill()});if(!i)throw new Error("canvas Element Or Element ID is required!");typeof i=="string"?this.$canvas=document.querySelector(i):this.$canvas=i,this.ctx=this.$canvas.getContext("2d"),this.cfg={...Et,...n},n!=null&&n.pointColor&&(this.cfg.pointerColor=n.pointColor),n!=null&&n.pointWidth&&(this.cfg.pointerWidth=n.pointWidth);const{fill:o,width:l,height:$,zoom:v,timeSpacingList:T,scaleHeight:y,textColor:w,bgTextColor:x}=this.cfg;if(x||(this.cfg.bgTextColor=Ot(w,.18)),v<0||v>=T.length||v%1!==0)throw new Error(`zoom must be 0 ~ ${T.length-1}, and must be an integer`);if(o){const p=this.$canvas.parentElement;this.$canvasParent=p,this.$canvas.width=p.clientWidth,this.$canvas.height=p.clientHeight,new ResizeObserver(pt(j(this,b,xt).bind(this),200)).observe(p)}else this.$canvas.width=l,this.$canvas.height=$;L(this,D,T[v]),y!=null&&y.long&&(y!=null&&y.short)?L(this,U,y):L(this,U,{long:this.$canvas.height/3,medium:this.$canvas.height/6,short:this.$canvas.height/10}),this.draw(),this.$canvas.addEventListener("wheel",j(this,b,Yt).bind(this),{passive:!1}),this.$canvas.addEventListener("mousedown",j(this,b,yt).bind(this)),this.$canvas.addEventListener("touchstart",j(this,b,bt).bind(this),{passive:!1}),this.$canvas.addEventListener("touchmove",j(this,b,wt).bind(this),{passive:!1}),this.$canvas.addEventListener("touchend",j(this,b,St).bind(this))}draw({currentTime:i,areas:n,_privateFlag:o}={}){if(a(this,P)&&!o)return;L(this,O,i||Date.now()),L(this,A,n||[]);const l=Math.ceil(this.$canvas.width/this.cfg.scaleSpacing),$=l*a(this,D),v=a(this,O)-$/2,T=a(this,O)+$/2,y=this.$canvas.width/2,w=$/this.$canvas.width;j(this,b,Ft).call(this),a(this,V).call(this,{startX:0,startY:0,endX:this.$canvas.width,endY:this.$canvas.height,bgColor:this.cfg.bgColor}),a(this,A).forEach(x=>{const p=x.startTime<=v?0:Math.round((x.startTime-v)/w),B=x.endTime>=T?this.$canvas.width:Math.round((x.endTime-v)/w);p<this.$canvas.width&&B>0&&a(this,V).call(this,{startX:p,startY:0,endX:B,endY:this.$canvas.height,bgColor:x.bgColor||this.cfg.areaBgColor})}),_t.bind(this)({xCenterPoint:y,screenScaleCount:l,startTime:v,timePerPixel:w,scaleHeight:a(this,U),timeSpacing:a(this,D),currentTime:a(this,O),$canvas:this.$canvas,cfg:this.cfg,drawLine:a(this,at).bind(this),drawText:a(this,K).bind(this),drawArea:a(this,V).bind(this)}),j(this,b,Ht).call(this)}getCurrentTime(){return a(this,O)}on(i,n){a(this,q).on(i,n)}off(i,n){a(this,q).off(i,n)}}q=new WeakMap,O=new WeakMap,A=new WeakMap,D=new WeakMap,U=new WeakMap,P=new WeakMap,I=new WeakMap,b=new WeakSet,yt=function(i){L(this,P,!0);let n=i.clientX,o=a(this,O);const l=pt(({clientX:T})=>{a(this,P)&&(o=Math.round(a(this,O)-a(this,D)/this.cfg.scaleSpacing*(T-n)),n=T,this.draw({currentTime:o,areas:a(this,A),_privateFlag:!0}))},1e3/this.cfg.fps),$=T=>{const y=this.$canvas.getBoundingClientRect(),w=T.clientX-y.left,x=T.clientY-y.top,p=3;(w<p||w>this.$canvas.width-p||x<p||x>this.$canvas.height-p)&&(this.$canvas.removeEventListener("mousemove",l),this.$canvas.removeEventListener("mousemove",$))},v=()=>{this.$canvas.removeEventListener("mousemove",l),this.$canvas.removeEventListener("mousemove",$),document.removeEventListener("mouseup",v),L(this,P,!1),j(this,b,$t).call(this,"dragged",o)};this.$canvas.addEventListener("mousemove",l),this.$canvas.addEventListener("mousemove",$),document.addEventListener("mouseup",v)},bt=function(i){i.preventDefault(),L(this,P,!0),L(this,I,i.touches[0].clientX)},wt=function(i){if(i.preventDefault(),!a(this,P)||a(this,I)===null)return;const n=i.touches[0],o=n.clientX-a(this,I),l=Math.round(a(this,O)-a(this,D)/this.cfg.scaleSpacing*o);L(this,I,n.clientX),this.draw({currentTime:l,areas:a(this,A),_privateFlag:!0})},St=function(){a(this,P)&&(L(this,P,!1),L(this,I,null),j(this,b,$t).call(this,"dragged",a(this,O)))},Yt=function(i){i.preventDefault();const n=this.cfg.timeSpacingList.findIndex(o=>o===a(this,D));i.deltaY<0&&n>0?(L(this,D,this.cfg.timeSpacingList[n-1]),this.draw({currentTime:a(this,O),areas:a(this,A),_privateFlag:!0})):i.deltaY>0&&n<this.cfg.timeSpacingList.length-1&&(L(this,D,this.cfg.timeSpacingList[n+1]),this.draw({currentTime:a(this,O),areas:a(this,A),_privateFlag:!0}))},xt=function(){this.$canvasParent&&(this.$canvas.width=this.$canvasParent.clientWidth,this.$canvas.height=this.$canvasParent.clientHeight,this.cfg.scaleHeight||L(this,U,{long:this.$canvas.height/3,medium:this.$canvas.height/6,short:this.$canvas.height/10}),this.draw({currentTime:a(this,O),areas:a(this,A)}))},Ft=function(){this.ctx.clearRect(0,0,this.$canvas.width,this.$canvas.height)},Ht=function(){const i=()=>a(this,D)<1e3?`${a(this,D)}ms`:a(this,D)<6e4?`${Math.round(a(this,D)/100)/10}sec`:a(this,D)<36e5?`${Math.round(a(this,D)/100/60)/10}min`:a(this,D)<864e5?`${Math.round(a(this,D)/100/60/60)/10}hours`:a(this,D)<6048e5?`${Math.round(a(this,D)/100/60/60/24)/10}days`:`${Math.round(a(this,D)/100/60/60/24/7)/10}weeks`;a(this,K).call(this,{x:this.cfg.scaleSpacing+12,y:9,text:i(),align:"left",baseLine:"middle"}),this.ctx.beginPath(),this.ctx.moveTo(5,6),this.ctx.lineTo(5,10),this.ctx.lineTo(this.cfg.scaleSpacing+6,10),this.ctx.lineTo(this.cfg.scaleSpacing+6,6),this.ctx.strokeStyle=this.cfg.scaleColor,this.ctx.lineWidth=1.5,this.ctx.stroke()},at=new WeakMap,K=new WeakMap,V=new WeakMap,$t=function(...i){a(this,q).emit(...i)},d.default=Wt,d.format=rt,Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
