/*!
 *  znu-event v0.0.10
 *  (c) 2020-2020 chenwuai
 *  https://github.com/chenchenwuai/znu-event.git
 * Released under the MIT License.
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function t(t){var i="function"==typeof Symbol&&Symbol.iterator,e=i&&t[i],n=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")}function i(t,i){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var n,s,r=e.call(t),h=[];try{for(;(void 0===i||i-- >0)&&!(n=r.next()).done;)h.push(n.value)}catch(t){s={error:t}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(s)throw s.error}}return h}function e(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t}var n=function(){function n(){this._listenersMap={}}return n.prototype.on=function(t,i){return void 0===this._listenersMap[t]&&(this._listenersMap[t]=[]),this._listenersMap[t].push(i),this},n.prototype.once=function(t,i){return i.isOnce=!0,this.on(t,i),this},n.prototype.off=function(t,i){var e=this._listenersMap[t];if(void 0!==e)if(void 0===i)delete this._listenersMap[t];else{var n=e.findIndex((function(t){return t===i}));e.splice(n,1)}return this},n.prototype.offAll=function(){this._listenersMap={}},n.prototype.emit=function(n){for(var s,r,h=[],a=1;a<arguments.length;a++)h[a-1]=arguments[a];var o=this._listenersMap[n];if(void 0!==o&&o.length>0){try{for(var u=t(o.entries()),c=u.next();!c.done;c=u.next()){var d=i(c.value,2),f=d[0],m=d[1];if(m.isOnce){var l=m;o.splice(f,1),l.apply(void 0,e(h))}else m.apply(void 0,e(h))}}catch(t){s={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(s)throw s.error}}return!0}return!1},n.prototype.has=function(t){return void 0!==this._listenersMap[t]&&this._listenersMap[t].length>0},n.prototype.eventNames=function(){var t=[];for(var i in this._listenersMap)t.push(i);return t},n.prototype.destroy=function(){this.offAll()},n}(),s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},r=/^\s+|\s+$/g,h=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,o=/^0o[0-7]+$/i,u=parseInt,c="object"==typeof s&&s&&s.Object===Object&&s,d="object"==typeof self&&self&&self.Object===Object&&self,f=c||d||Function("return this")(),m=Object.prototype.toString,l=Math.max,p=Math.min,g=function(){return f.Date.now()};function w(t,i,e){var n,s,r,h,a,o,u=0,c=!1,d=!1,f=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function m(i){var e=n,r=s;return n=s=void 0,u=i,h=t.apply(r,e)}function w(t){return u=t,a=setTimeout(H,i),c?m(t):h}function T(t){var e=t-o;return void 0===o||e>=i||e<0||d&&t-u>=r}function H(){var t=g();if(T(t))return y(t);a=setTimeout(H,function(t){var e=i-(t-o);return d?p(e,r-(t-u)):e}(t))}function y(t){return a=void 0,f&&n?m(t):(n=s=void 0,h)}function x(){var t=g(),e=T(t);if(n=arguments,s=this,o=t,e){if(void 0===a)return w(o);if(d)return a=setTimeout(H,i),m(o)}return void 0===a&&(a=setTimeout(H,i)),h}return i=$(i)||0,v(e)&&(c=!!e.leading,r=(d="maxWait"in e)?l($(e.maxWait)||0,i):r,f="trailing"in e?!!e.trailing:f),x.cancel=function(){void 0!==a&&clearTimeout(a),u=0,n=o=s=a=void 0},x.flush=function(){return void 0===a?h:y(g())},x}function v(t){var i=typeof t;return!!t&&("object"==i||"function"==i)}function $(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==m.call(t)}(t))return NaN;if(v(t)){var i="function"==typeof t.valueOf?t.valueOf():t;t=v(i)?i+"":i}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(r,"");var e=a.test(t);return e||o.test(t)?u(t.slice(2),e?2:8):h.test(t)?NaN:+t}var T=function(t,i,e){var n=!0,s=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return v(e)&&(n="leading"in e?!!e.leading:n,s="trailing"in e?!!e.trailing:s),w(t,i,{leading:n,maxWait:i,trailing:s})},H={exports:{}},y=H.exports=function(){var t=1e3,i=6e4,e=36e5,n="millisecond",s="second",r="minute",h="hour",a="day",o="week",u="month",c="quarter",d="year",f="date",m="Invalid Date",l=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},w=function(t,i,e){var n=String(t);return!n||n.length>=i?t:""+Array(i+1-n.length).join(e)+t},v={s:w,z:function(t){var i=-t.utcOffset(),e=Math.abs(i),n=Math.floor(e/60),s=e%60;return(i<=0?"+":"-")+w(n,2,"0")+":"+w(s,2,"0")},m:function t(i,e){if(i.date()<e.date())return-t(e,i);var n=12*(e.year()-i.year())+(e.month()-i.month()),s=i.clone().add(n,u),r=e-s<0,h=i.clone().add(n+(r?-1:1),u);return+(-(n+(e-s)/(r?s-h:h-s))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:u,y:d,w:o,d:a,D:f,h:h,m:r,s:s,ms:n,Q:c}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},$="en",T={};T[$]=g;var H=function(t){return t instanceof M},y=function t(i,e,n){var s;if(!i)return $;if("string"==typeof i){var r=i.toLowerCase();T[r]&&(s=r),e&&(T[r]=e,s=r);var h=i.split("-");if(!s&&h.length>1)return t(h[0])}else{var a=i.name;T[a]=i,s=a}return!n&&s&&($=s),s||!n&&$},x=function(t,i){if(H(t))return t.clone();var e="object"==typeof i?i:{};return e.date=t,e.args=arguments,new M(e)},S=v;S.l=y,S.i=H,S.w=function(t,i){return x(t,{locale:i.$L,utc:i.$u,x:i.$x,$offset:i.$offset})};var M=function(){function g(t){this.$L=y(t.locale,null,!0),this.parse(t)}var w=g.prototype;return w.parse=function(t){this.$d=function(t){var i=t.date,e=t.utc;if(null===i)return new Date(NaN);if(S.u(i))return new Date;if(i instanceof Date)return new Date(i);if("string"==typeof i&&!/Z$/i.test(i)){var n=i.match(l);if(n){var s=n[2]-1||0,r=(n[7]||"0").substring(0,3);return e?new Date(Date.UTC(n[1],s,n[3]||1,n[4]||0,n[5]||0,n[6]||0,r)):new Date(n[1],s,n[3]||1,n[4]||0,n[5]||0,n[6]||0,r)}}return new Date(i)}(t),this.$x=t.x||{},this.init()},w.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},w.$utils=function(){return S},w.isValid=function(){return!(this.$d.toString()===m)},w.isSame=function(t,i){var e=x(t);return this.startOf(i)<=e&&e<=this.endOf(i)},w.isAfter=function(t,i){return x(t)<this.startOf(i)},w.isBefore=function(t,i){return this.endOf(i)<x(t)},w.$g=function(t,i,e){return S.u(t)?this[i]:this.set(e,t)},w.unix=function(){return Math.floor(this.valueOf()/1e3)},w.valueOf=function(){return this.$d.getTime()},w.startOf=function(t,i){var e=this,n=!!S.u(i)||i,c=S.p(t),m=function(t,i){var s=S.w(e.$u?Date.UTC(e.$y,i,t):new Date(e.$y,i,t),e);return n?s:s.endOf(a)},l=function(t,i){return S.w(e.toDate()[t].apply(e.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(i)),e)},p=this.$W,g=this.$M,w=this.$D,v="set"+(this.$u?"UTC":"");switch(c){case d:return n?m(1,0):m(31,11);case u:return n?m(1,g):m(0,g+1);case o:var $=this.$locale().weekStart||0,T=(p<$?p+7:p)-$;return m(n?w-T:w+(6-T),g);case a:case f:return l(v+"Hours",0);case h:return l(v+"Minutes",1);case r:return l(v+"Seconds",2);case s:return l(v+"Milliseconds",3);default:return this.clone()}},w.endOf=function(t){return this.startOf(t,!1)},w.$set=function(t,i){var e,o=S.p(t),c="set"+(this.$u?"UTC":""),m=(e={},e[a]=c+"Date",e[f]=c+"Date",e[u]=c+"Month",e[d]=c+"FullYear",e[h]=c+"Hours",e[r]=c+"Minutes",e[s]=c+"Seconds",e[n]=c+"Milliseconds",e)[o],l=o===a?this.$D+(i-this.$W):i;if(o===u||o===d){var p=this.clone().set(f,1);p.$d[m](l),p.init(),this.$d=p.set(f,Math.min(this.$D,p.daysInMonth())).$d}else m&&this.$d[m](l);return this.init(),this},w.set=function(t,i){return this.clone().$set(t,i)},w.get=function(t){return this[S.p(t)]()},w.add=function(n,c){var f,m=this;n=Number(n);var l=S.p(c),p=function(t){var i=x(m);return S.w(i.date(i.date()+Math.round(t*n)),m)};if(l===u)return this.set(u,this.$M+n);if(l===d)return this.set(d,this.$y+n);if(l===a)return p(1);if(l===o)return p(7);var g=(f={},f[r]=i,f[h]=e,f[s]=t,f)[l]||1,w=this.$d.getTime()+n*g;return S.w(w,this)},w.subtract=function(t,i){return this.add(-1*t,i)},w.format=function(t){var i=this,e=this.$locale();if(!this.isValid())return e.invalidDate||m;var n=t||"YYYY-MM-DDTHH:mm:ssZ",s=S.z(this),r=this.$H,h=this.$m,a=this.$M,o=e.weekdays,u=e.months,c=function(t,e,s,r){return t&&(t[e]||t(i,n))||s[e].slice(0,r)},d=function(t){return S.s(r%12||12,t,"0")},f=e.meridiem||function(t,i,e){var n=t<12?"AM":"PM";return e?n.toLowerCase():n},l={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:S.s(a+1,2,"0"),MMM:c(e.monthsShort,a,u,3),MMMM:c(u,a),D:this.$D,DD:S.s(this.$D,2,"0"),d:String(this.$W),dd:c(e.weekdaysMin,this.$W,o,2),ddd:c(e.weekdaysShort,this.$W,o,3),dddd:o[this.$W],H:String(r),HH:S.s(r,2,"0"),h:d(1),hh:d(2),a:f(r,h,!0),A:f(r,h,!1),m:String(h),mm:S.s(h,2,"0"),s:String(this.$s),ss:S.s(this.$s,2,"0"),SSS:S.s(this.$ms,3,"0"),Z:s};return n.replace(p,(function(t,i){return i||l[t]||s.replace(":","")}))},w.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},w.diff=function(n,f,m){var l,p=S.p(f),g=x(n),w=(g.utcOffset()-this.utcOffset())*i,v=this-g,$=S.m(this,g);return $=(l={},l[d]=$/12,l[u]=$,l[c]=$/3,l[o]=(v-w)/6048e5,l[a]=(v-w)/864e5,l[h]=v/e,l[r]=v/i,l[s]=v/t,l)[p]||v,m?$:S.a($)},w.daysInMonth=function(){return this.endOf(u).$D},w.$locale=function(){return T[this.$L]},w.locale=function(t,i){if(!t)return this.$L;var e=this.clone(),n=y(t,i,!0);return n&&(e.$L=n),e},w.clone=function(){return S.w(this.$d,this)},w.toDate=function(){return new Date(this.valueOf())},w.toJSON=function(){return this.isValid()?this.toISOString():null},w.toISOString=function(){return this.$d.toISOString()},w.toString=function(){return this.$d.toUTCString()},g}(),L=M.prototype;return x.prototype=L,[["$ms",n],["$s",s],["$m",r],["$H",h],["$W",a],["$M",u],["$y",d],["$D",f]].forEach((function(t){L[t[1]]=function(i){return this.$g(i,t[0],t[1])}})),x.extend=function(t,i){return t.$i||(t(i,M,x),t.$i=!0),x},x.locale=y,x.isDayjs=H,x.unix=function(t){return x(1e3*t)},x.en=T[$],x.Ls=T,x.p={},x}();const x=(t,i="MM/DD HH:mm")=>y(1e3*t).format(i);class S{constructor(t,i=!1){var e,s;if(!t)throw new Error("canvas id is required!");this.$canvas=document.getElementById(t),this.canvasContext=this.$canvas.getContext("2d"),i&&(this.$canvas.width=null===(e=this.$canvas.parentNode)||void 0===e?void 0:e.clientWidth,this.$canvas.height=null===(s=this.$canvas.parentNode)||void 0===s?void 0:s.clientHeight),this.event=new n,this.startTime=0,this.endTime=0,this.currentTime=0,this.timeSpacingMap=[5,10,30,60,120,300],this.timeSpacing=30,this.spacing=5,this.pointHeight={hour1:this.$canvas.height/2,minute30:this.$canvas.height/3,minute10:this.$canvas.height/4,minute1:this.$canvas.height/5,second10:this.$canvas.height/8,second5:this.$canvas.height/10},this.centerTimePointWidth=3}draw({startTime:t,endTime:i,currentTime:e,areas:n}){if(this.clear(),!t||!i)throw new Error("startTime and endTime is required!");this.startTime=t,this.endTime=i,this.currentTime=e||this.startTime,this.areas=n||[],this.areas.forEach((t=>{this.drawArea(t.startTime,t.endTime,t.bgColor)}));const s=Math.ceil((this.currentTime-this.startTime)/this.timeSpacing),r=Math.ceil((this.endTime-this.currentTime)/this.timeSpacing),h=this.$canvas.width/2-this.centerTimePointWidth/2,a=this.currentTime%this.spacing,o=this.currentTime%this.timeSpacing;if(5===this.timeSpacing){for(let t=0;t<s;t++){const i=h-t*this.spacing-a,e=this.currentTime-t*this.timeSpacing-o;e%3600!=0?e%1800!=0?e%600!=0?e%60!=0?e%5!=0||this.drawLine(i,this.pointHeight.second5):(this.drawLine(i,this.pointHeight.minute1),this.drawText(i-15,20,`${x(e,"HH:mm")}`)):(this.drawLine(i,this.pointHeight.minute10),this.drawText(i-15,20,`${x(e,"HH:mm")}`)):(this.drawLine(i,this.pointHeight.minute30),this.drawText(i-30,20,`${x(e)}`)):(this.drawLine(i,this.pointHeight.hour1),this.drawText(i-30,20,`${x(e)}`))}for(let t=0;t<r;t++){const i=h+t*this.spacing-a,e=this.currentTime+t*this.timeSpacing-o;e%3600!=0?e%1800!=0?e%600!=0?e%60!=0?e%5!=0||this.drawLine(i,this.pointHeight.second5):(this.drawLine(i,this.pointHeight.minute1),this.drawText(i-15,20,`${x(e,"HH:mm")}`)):(this.drawLine(i,this.pointHeight.minute10),this.drawText(i-15,20,`${x(e,"HH:mm")}`)):(this.drawLine(i,this.pointHeight.minute30),this.drawText(i-30,20,`${x(e)}`)):(this.drawLine(i,this.pointHeight.hour1),this.drawText(i-30,20,`${x(e)}`))}}if(10===this.timeSpacing){for(let t=0;t<s;t++){const i=h-t*this.spacing-a,e=this.currentTime-t*this.timeSpacing-o;e%3600!=0?e%1800!=0?e%600!=0?e%60!=0?e%10!=0||this.drawLine(i,this.pointHeight.second5):(this.drawLine(i,this.pointHeight.minute1),e%120==0&&this.drawText(i-15,20,`${x(e,"HH:mm")}`)):(this.drawLine(i,this.pointHeight.minute10),this.drawText(i-15,20,`${x(e,"HH:mm")}`)):(this.drawLine(i,this.pointHeight.minute30),this.drawText(i-30,20,`${x(e)}`)):(this.drawLine(i,this.pointHeight.hour1),this.drawText(i-30,20,`${x(e)}`))}for(let t=0;t<r;t++){const i=h+t*this.spacing-a,e=this.currentTime+t*this.timeSpacing-o;e%3600!=0?e%1800!=0?e%600!=0?e%60!=0?e%10!=0||this.drawLine(i,this.pointHeight.second5):(this.drawLine(i,this.pointHeight.minute1),e%120==0&&this.drawText(i-15,20,`${x(e,"HH:mm")}`)):(this.drawLine(i,this.pointHeight.minute10),this.drawText(i-15,20,`${x(e,"HH:mm")}`)):(this.drawLine(i,this.pointHeight.minute30),this.drawText(i-30,20,`${x(e)}`)):(this.drawLine(i,this.pointHeight.hour1),this.drawText(i-30,20,`${x(e)}`))}}if(30===this.timeSpacing){for(let t=0;t<s;t++){const i=h-t*this.spacing-a,e=this.currentTime-t*this.timeSpacing-o;e%3600!=0?e%1800!=0?e%600!=0?e%120!=0?e%30!=0||this.drawLine(i,this.pointHeight.second5):this.drawLine(i,this.pointHeight.minute1):(this.drawLine(i,this.pointHeight.minute10),this.drawText(i-15,20,`${x(e,"HH:mm")}`)):(this.drawLine(i,this.pointHeight.minute30),this.drawText(i-30,20,`${x(e)}`)):(this.drawLine(i,this.pointHeight.hour1),this.drawText(i-30,20,`${x(e)}`))}for(let t=0;t<r;t++){const i=h+t*this.spacing-a,e=this.currentTime+t*this.timeSpacing-o;e%3600!=0?e%1800!=0?e%600!=0?e%120!=0?e%30!=0||this.drawLine(i,this.pointHeight.second5):this.drawLine(i,this.pointHeight.minute1):(this.drawLine(i,this.pointHeight.minute10),this.drawText(i-15,20,`${x(e,"HH:mm")}`)):(this.drawLine(i,this.pointHeight.minute30),this.drawText(i-30,20,`${x(e)}`)):(this.drawLine(i,this.pointHeight.hour1),this.drawText(i-30,20,`${x(e)}`))}}if(60===this.timeSpacing){for(let t=0;t<s;t++){const i=h-t*this.spacing-a,e=this.currentTime-t*this.timeSpacing-o;e%3600!=0?e%1800!=0?e%600!=0?e%300!=0?e%60!=0||this.drawLine(i,this.pointHeight.second5):this.drawLine(i,this.pointHeight.minute1):(this.drawLine(i,this.pointHeight.minute10),this.drawText(i-15,20,`${x(e,"HH:mm")}`)):(this.drawLine(i,this.pointHeight.minute30),this.drawText(i-30,20,`${x(e)}`)):(this.drawLine(i,this.pointHeight.hour1),this.drawText(i-30,20,`${x(e)}`))}for(let t=0;t<r;t++){const i=h+t*this.spacing-a,e=this.currentTime+t*this.timeSpacing-o;e%3600!=0?e%1800!=0?e%600!=0?e%300!=0?e%60!=0||this.drawLine(i,this.pointHeight.second5):this.drawLine(i,this.pointHeight.minute1):(this.drawLine(i,this.pointHeight.minute10),this.drawText(i-15,20,`${x(e,"HH:mm")}`)):(this.drawLine(i,this.pointHeight.minute30),this.drawText(i-30,20,`${x(e)}`)):(this.drawLine(i,this.pointHeight.hour1),this.drawText(i-30,20,`${x(e)}`))}}if(120===this.timeSpacing){for(let t=0;t<s;t++){const i=h-t*this.spacing-a,e=this.currentTime-t*this.timeSpacing-o;e%3600!=0?e%1800!=0?e%600!=0?e%120!=0||this.drawLine(i,this.pointHeight.second5):this.drawLine(i,this.pointHeight.minute1):(this.drawLine(i,this.pointHeight.minute30),this.drawText(i-30,20,`${x(e)}`)):(this.drawLine(i,this.pointHeight.hour1),this.drawText(i-30,20,`${x(e)}`))}for(let t=0;t<r;t++){const i=h+t*this.spacing-a,e=this.currentTime+t*this.timeSpacing-o;e%3600!=0?e%1800!=0?e%600!=0?e%120!=0||this.drawLine(i,this.pointHeight.second5):this.drawLine(i,this.pointHeight.minute1):(this.drawLine(i,this.pointHeight.minute30),this.drawText(i-30,20,`${x(e)}`)):(this.drawLine(i,this.pointHeight.hour1),this.drawText(i-30,20,`${x(e)}`))}}if(300===this.timeSpacing){for(let t=0;t<s;t++){const i=h-t*this.spacing-a,e=this.currentTime-t*this.timeSpacing-o;e%3600!=0?e%1800!=0?e%600!=0&&e%300!=0||this.drawLine(i,this.pointHeight.second5):this.drawLine(i,this.pointHeight.minute10):(this.drawLine(i,this.pointHeight.hour1),this.drawText(i-15,20,`${x(e,"HH:mm")}`))}for(let t=0;t<r;t++){const i=h+t*this.spacing-a,e=this.currentTime+t*this.timeSpacing-o;e%3600!=0?e%1800!=0?e%600!=0&&e%300!=0||this.drawLine(i,this.pointHeight.second5):this.drawLine(i,this.pointHeight.minute10):(this.drawLine(i,this.pointHeight.hour1),this.drawText(i-15,20,`${x(e,"HH:mm")}`))}}this.drawLine(h,this.$canvas.height,this.centerTimePointWidth,"#00AEEC"),this.$canvas.onwheel=this._onZoom.bind(this),this.$canvas.onmousedown=this._onDrag.bind(this)}_onDrag(t){const i=(t=t||window.event).clientX;let e=0;document.onmousemove=T((t=>{const n=(t=t||window.event).clientX-i;if(n<0&&this.currentTime>=this.endTime)return;if(n>0&&this.currentTime<=this.startTime)return;const s=this.currentTime-this.timeSpacing/this.spacing*(n-e);e=n,this.draw({startTime:this.startTime,endTime:this.endTime,currentTime:Math.floor(s),areas:this.areas})}),80),document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null,this.emit("change",this.currentTime)}}_onZoom(t){t.preventDefault();const i=this.timeSpacingMap.findIndex((t=>t===this.timeSpacing));t.deltaY<0&&i>0?(this.timeSpacing=this.timeSpacingMap[i-1],this.draw({startTime:this.startTime,endTime:this.endTime,currentTime:this.currentTime,areas:this.areas})):t.deltaY>0&&i<this.timeSpacingMap.length-1&&(this.timeSpacing=this.timeSpacingMap[i+1],this.draw({startTime:this.startTime,endTime:this.endTime,currentTime:this.currentTime,areas:this.areas}))}clear(){this.canvasContext&&this.canvasContext.clearRect(0,0,this.$canvas.width,this.$canvas.height),this.$canvas&&(this.$canvas.onwheel=null,this.$canvas.onmousedown=null)}drawLine(t,i,e=1,n="#ffffff"){this.canvasContext.beginPath(),this.canvasContext.moveTo(t,this.$canvas.height),this.canvasContext.lineTo(t,this.$canvas.height-i),this.canvasContext.stroke(),this.canvasContext.strokeStyle=n,this.canvasContext.lineWidth=e,this.canvasContext.stroke(),this.canvasContext.closePath()}drawText(t,i,e,n="#ffffff"){this.canvasContext.beginPath(),this.canvasContext.fillStyle=n,this.canvasContext.fillText(e,t,i),this.canvasContext.closePath()}drawArea(t,i,e){const n=this.$canvas.width/2-this.centerTimePointWidth/2,s=this.currentTime%this.spacing,r=n-s+Math.floor((t-this.currentTime)/this.timeSpacing)*this.spacing,h=n-s+Math.floor((i-this.currentTime)/this.timeSpacing)*this.spacing;this.canvasContext.beginPath(),this.canvasContext.rect(r,0,h-r,this.$canvas.height),this.canvasContext.fillStyle=e||"#ffffff",this.canvasContext.fill(),this.canvasContext.closePath()}on(t,i){this.event.on(t,i)}off(t,i){this.event.off(t,i)}emit(...t){this.event.emit(...t)}}export{S as default};
//# sourceMappingURL=moe-timeline.esm.min.js.map
